(e=>{var t={};function r(i){var s;return(t[i]||(s=t[i]={i:i,l:!1,exports:{}},e[i].call(s.exports,s,s.exports,r),s.l=!0,s)).exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(i,s,function(t){return e[t]}.bind(null,s));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)})([function(e,t,r){r.r(t);let i=240,s=0,a=16,o=32,n=48,h=64,l=80,c=96,u=112,f=128,p=144,w=160,d=176,y=192,b=224,g=240,v=0,V=1,k=2,A=3,m=16,U=17,B=18,S=19,O=20,I=21,E=22,z=23,M=24,P=25,j=26,x=32,F=33,T=34,R=35,C=48,D=49,N=50,W=51,_=52,L=53,$=54,q=55,G=64,H=65,J=66,K=67,Q=68,X=69,Y=70,Z=71,ee=80,te=81,re=82,ie=83,se=84,ae=85,oe=96,ne=97,he=98,le=99,ce=100,ue=101,fe=102,pe=103,we=104,de=105,ye=106,be=107,ge=112,ve=113,Ve=114,ke=128,Ae=129,me=144,Ue=145,Be=160,Se=161,Oe=162,Ie=163,Ee=164,ze=165,Me=166,Pe=167,je=168,xe=176,Fe=192,Te=193,Re=208,Ce=209,De=224,Ne=225,We=226,_e=227,Le=240,$e=new Uint8Array(256),qe=new Uint8Array(256);new Map;let Ge=new Map,He=new Map;var Je=[[U,2],[B,4],[S,4],[O,4],[I,8],[x,8],[F,8]];for(let e=0;e<Je.length;e++)$e[Je[e][0]]=Je[e][1];var Ke,Qe=[[oe,1],[ne,1],[he,1],[le,2],[ce,2],[ue,4],[fe,4],[pe,4],[we,8],[de,8],[ye,8],[K,1],[Q,2],[X,4],[Y,4],[Z,8]];for(let e=0;e<Qe.length;e++)qe[Qe[e][0]]=Qe[e][1];for(Ke of["asyncIterator","hasInstance","isConcatSpreadable","iterator","match","matchAll","replace","search","species","split","toPrimitive","toStringTag","unscopables"]){var Xe=Symbol[Ke];Xe&&(Ge.set(Xe,Ke),He.set(Ke,Xe))}class Ye{constructor(e=65536){this.size=(e+128-1&-128)>>>0,this.buffer=new ArrayBuffer(this.size),this.offset=0,this.u8=new Uint8Array(this.buffer),this.view=new DataView(this.buffer),this.pos=0,this.f32View=null,this.f64View=null,this.i32View=null}ensure(e){var t,r;(e=this.pos+(e|=0)|0)>this.size&&(e=(128+(0|Math.max(this.size<<1,e+128))-1&-128)>>>0,t=new ArrayBuffer(e),(r=new Uint8Array(t)).set(this.u8.subarray(0,this.pos)),this.buffer=t,this.u8=r,this.view=new DataView(t),this.size=e,this.f32View=null,this.f64View=null,this.i32View=null)}alignPos(e){e=e-1|0,this.pos=(this.pos+e&~e)>>>0}writeU8(e){this.ensure(1),this.u8[this.pos++]=255&e}writeU16(e){this.alignPos(2),this.ensure(2),this.view.setUint16(this.pos,65535&e,!0),this.pos=this.pos+2|0}writeI16(e){this.alignPos(2),this.ensure(2),this.view.setInt16(this.pos,e,!0),this.pos=this.pos+2|0}writeU32(e){this.alignPos(4),this.ensure(4),this.view.setUint32(this.pos,e>>>0,!0),this.pos=this.pos+4|0}writeI32(e){this.alignPos(4),this.ensure(4),this.view.setInt32(this.pos,0|e,!0),this.pos=this.pos+4|0}writeF32(e){this.alignPos(4),this.ensure(4),this.view.setFloat32(this.pos,+e,!0),this.pos=this.pos+4|0}writeF64(e){this.alignPos(8),this.ensure(8),this.view.setFloat64(this.pos,+e,!0),this.pos=this.pos+8|0}writeBigInt64(e){this.alignPos(8),this.ensure(8),this.view.setBigInt64(this.pos,BigInt(e),!0),this.pos=this.pos+8|0}writeVarint(e){if(e>>>=0,this.ensure(5),e<128)this.u8[this.pos++]=e;else if(e<16384)this.u8[this.pos]=127&e|128,this.u8[this.pos+1]=e>>>7,this.pos=this.pos+2|0;else{let t=this.pos;for(;this.u8[t++]=127&e|128,128<=(e>>>=7););this.u8[t++]=e,this.pos=t}}writePackedArray(e,t){var r=0|e.length,i=(this.writeVarint(r),0|qe[t]);if(!i)throw new Error("Unknown element type: 0x"+t.toString(16));switch(this.alignPos(Math.min(i,8)),this.ensure(r*i),t){case K:new Int8Array(this.buffer,this.pos,r).set(e),this.pos=this.pos+r|0;break;case Q:var s=new Int16Array(this.buffer,this.pos,r);for(let t=0;t<r;t++)s[t]=0|e[t];this.pos=this.pos+(r<<1)|0;break;case X:var a=new Int32Array(this.buffer,this.pos,r);for(let t=0;t<r;t++)a[t]=0|e[t];this.pos=this.pos+(r<<2)|0;break;case Y:var o=new Float32Array(this.buffer,this.pos,r);for(let t=0;t<r;t++)o[t]=+e[t];this.pos=this.pos+(r<<2)|0;break;case Z:var n=new Float64Array(this.buffer,this.pos,r);for(let t=0;t<r;t++)n[t]=+e[t];this.pos=this.pos+(r<<3)|0;break;default:throw new Error("Unsupported packed array type: 0x"+t.toString(16))}}writeBulkAligned(e,t){var r;t=Math.min(t,8),this.alignPos(t),t=e.byteLength||e.length;this.ensure(t),e.buffer&&void 0!==e.byteOffset?(r=new Uint8Array(e.buffer,e.byteOffset,t),this.u8.set(r,this.pos)):this.u8.set(e,this.pos),this.pos=this.pos+t|0}reset(){this.pos=0}getResult(){return this.u8.subarray(0,this.pos)}}class Ze{constructor(){this.blockSize=16}canOptimize(e){var t=e.length;if(!(8<=t&(0==(t&t-1)||16<=t)))return!1;var r=typeof e[0];if("number"!=r)return!1;var i=Math.max(1,t>>>5|0);for(let s=i;s<t;s+=i)if(typeof e[s]!=r)return!1;return!0}analyzeNumericArray(e){let t=1,r=1/0,i=-1/0,s=1;var a,o=e.length;for(let a=0;a<o;a++){var n=e[a];t&=+(n==(0|n)),r=Math.min(r,n),i=Math.max(i,n),s&&(s&=+(Math.fround(n)==n))}return t?(a=+((a=Math.max(Math.abs(r),Math.abs(i)))<=127)<<0|+(a<=32767)<<1|+(a<=2147483647)<<2,[{type:X,elementSize:4},{type:K,elementSize:1},{type:Q,elementSize:2},{type:X,elementSize:4}][3&a]):s?{type:Y,elementSize:4}:{type:Z,elementSize:8}}}class et{constructor(){this.simdProcessor=new Ze,this.constructorMap=new Map,this.typeNameMap=new Map,this.errorTypeMap=new Map,this.initMaps()}initMaps(){var e,t,r,i,s=[[Date,me],[RegExp,xe],[Map,ke],[Set,Ae],[ArrayBuffer,ge],[DataView,be]],a=[["Uint8Array",oe],["Int8Array",ne],["Uint8ClampedArray",he],["Uint16Array",le],["Int16Array",ce],["Uint32Array",ue],["Int32Array",fe],["Float32Array",pe],["Float64Array",we],["BigInt64Array",de],["BigUint64Array",ye],["SharedArrayBuffer",Ve]];for([e,t]of s)this.constructorMap.set(e,t);for([r,i]of a){var o=globalThis[r];o&&(this.constructorMap.set(o,i),this.typeNameMap.set(r,i))}this.errorTypeMap.set("Error",Be),this.errorTypeMap.set("EvalError",Se),this.errorTypeMap.set("RangeError",Oe),this.errorTypeMap.set("ReferenceError",Ie),this.errorTypeMap.set("SyntaxError",Ee),this.errorTypeMap.set("TypeError",ze),this.errorTypeMap.set("URIError",Me),this.errorTypeMap.set("AggregateError",Pe)}detect(e){if(null==e)return null===e?v:V;switch(typeof e){case"boolean":return e?A:k;case"number":return this.detectNumber(e);case"bigint":return this.detectBigInt(e);case"string":return this.detectString(e);case"symbol":return this.detectSymbol(e);case"object":return this.detectObject(e);default:return V}}detectNumber(e){var t,r,i;return e!=e?E:(i=new Float64Array([e]),((t=(i=new Uint32Array(i.buffer))[1])&(r=2146435072))==r&0==i[0]&0==(1048575&t)?t>>>31?M:z:0==e&&t>>>31?P:e==(0|e)?(i=+((r=Math.abs(e))<=127)<<0|+(r<=32767)<<1|+(r<=2147483647)<<2,[j,m,U,B][Math.min(i,3)]):Math.fround(e)==e?O:I)}detectBigInt(e){var t=e<0n;return(t?-e:e)<=0x7fffffffffffffffn?t?F:x:t?R:T}detectString(e){var t,r=e.length;if(0==r)return C;let i=1;for(let t=0;t<r&&i;t++)i&=+(e.charCodeAt(t)<=127);return i?r<16?D:r<256?N:W:(t=(new TextEncoder).encode(e).length)<16?_:t<256?L:$}detectSymbol(e){return void 0!==Symbol.keyFor(e)?Ne:Ge.has(e)?We:void 0===e.description?_e:De}detectObject(e){var t,r;return null==e?v:(t=e.constructor,void 0!==(t=this.constructorMap.get(t))?t==me?(r=e.getTime())==r?me:Ue:t:Array.isArray(e)?this.detectArray(e):ArrayBuffer.isView(e)?this.detectTypedArrayType(e):e instanceof Error?this.detectErrorType(e):"undefined"!=typeof Blob&&e instanceof Blob?e instanceof File?Te:Fe:this.classifyObject(e))}classifyObject(e){var t=Object.getPrototypeOf(e);if(e.constructor!=Object&&t!=Object.prototype&&null!=t)return ie;t=Object.getOwnPropertyNames(e);var r,i=Object.getOwnPropertySymbols(e);if(0===(t=[...t,...i]).length)return ee;let s=!1,a=!1;for(r of t){var o=Object.getOwnPropertyDescriptor(e,r);if(o.get||o.set){s=!0;break}"function"==typeof o.value&&(a=!0),o.enumerable&&o.writable&&o.configurable||(s=!0)}return s?se:a?ae:re}detectArray(e){var t=e.length;if(0==t)return G;let r=0,i=!1;for(let s=0;s<t;s++)s in e?r++:i=!0;return i||r<3*t>>>2?J:this.simdProcessor.canOptimize(e)?this.simdProcessor.analyzeNumericArray(e).type:H}detectTypedArrayType(e){return e=e.constructor.name,this.typeNameMap.get(e)||oe}detectErrorType(e){return e=e.constructor.name,this.errorTypeMap.get(e)||je}}t.default=class{constructor(e={}){this.options={compression:e.compression||!1,deduplication:!1!==e.deduplication,shareArrayBuffers:!1!==e.shareArrayBuffers,simdOptimization:!1!==e.simdOptimization,detectCircular:!1!==e.detectCircular,serializeFunctions:e.serializeFunctions||!1,preservePropertyDescriptors:!1!==e.preservePropertyDescriptors,memoryPoolSize:e.memoryPoolSize||65536,...e},this.pool=new Ye(this.options.memoryPoolSize),this.detector=new et,this.simdProcessor=new Ze,this.refs=new Map,this.circularRefs=new Set,this.strings=new Map,this.buffers=new Map,this.encoder=new TextEncoder,this.decoder=new TextDecoder}serialize(e){return this.resetState(),this.pool.writeU32(1413632565),this.pool.writeU8(5),this.options.detectCircular&&this.detectCircularReferences(e,new WeakSet),this.writeValue(e),this.pool.getResult()}resetState(){this.pool.reset(),this.refs.clear(),this.circularRefs.clear(),this.strings.clear(),this.buffers.clear()}detectCircularReferences(e,t){if("object"==typeof e&&null!=e)if(t.has(e))this.circularRefs.add(e);else{t.add(e);try{if(Array.isArray(e))for(let r=0;r<e.length;r++)r in e&&this.detectCircularReferences(e[r],t);else if(e instanceof Map)for(var[r,i]of e)this.detectCircularReferences(r,t),this.detectCircularReferences(i,t);else if(e instanceof Set)for(var s of e)this.detectCircularReferences(s,t);else for(var a in e)if(e.hasOwnProperty(a))try{this.detectCircularReferences(e[a],t)}catch(r){}}finally{t.delete(e)}}}writeValue(e){if(this.options.detectCircular&&"object"==typeof e&&null!=e&&this.circularRefs.has(e)){if(void 0!==(t=this.refs.get(e)))return this.pool.writeU8(Ce),void this.pool.writeVarint(t);this.refs.set(e,this.refs.size)}if(this.options.deduplication&&"object"==typeof e&&null!=e&&!this.circularRefs.has(e)){if(void 0!==(t=this.refs.get(e)))return this.pool.writeU8(Re),void this.pool.writeVarint(t);this.refs.set(e,this.refs.size)}if(this.options.deduplication&&"string"==typeof e&&3<e.length){if(void 0!==(t=this.strings.get(e)))return this.pool.writeU8(q),void this.pool.writeVarint(t);this.strings.set(e,this.strings.size)}if(this.options.shareArrayBuffers&&e instanceof ArrayBuffer){if(void 0!==(t=this.buffers.get(e)))return this.pool.writeU8(ve),void this.pool.writeVarint(t);this.buffers.set(e,this.buffers.size)}var t,r=this.detector.detect(e);switch(t=(this.pool.writeU8(r),r&i)){case s:break;case a:this.writeNumber(e,r);break;case o:this.writeBigInt(e,r);break;case n:this.writeString(e,r);break;case h:this.writeArray(e,r);break;case l:this.writeObject(e,r);break;case c:this.writeTypedArray(e,r);break;case u:this.writeArrayBuffer(e,r);break;case f:this.writeCollection(e,r);break;case p:this.writeDate(e,r);break;case w:this.writeError(e,r);break;case d:this.writeRegExp(e);break;case y:this.writeBinary(e,r);break;case b:this.writeSpecial(e,r);break;case g:this.writeExtension(e,r)}}writeNumber(e,t){switch(t){case m:this.pool.writeU8(e);break;case U:this.pool.writeI16(e);break;case B:this.pool.writeI32(e);break;case S:this.pool.writeU32(e);break;case O:this.pool.writeF32(e);break;case I:this.pool.writeF64(e);break;case j:var r=e<0;this.pool.writeVarint(Math.abs(e)),this.pool.writeU8(r?1:0)}}writeBigInt(e,t){switch(t){case x:case F:this.pool.writeBigInt64(e);break;case T:case R:this.writeLargeBigInt(e)}}writeLargeBigInt(e){var t,r=BigInt(e).toString(16).replace("-",""),i=[];for(let e=r.length-2;0<=e;e-=2)i.push(parseInt(r.substr(e,2),16));for(t of(r.length%2&&i.push(parseInt(r[0],16)),this.pool.writeVarint(i.length),i))this.pool.writeU8(t)}writeString(e,t){var r=e.length;switch(t){case C:break;case D:case N:this.pool.writeU8(r);for(let t=0;t<r;t++)this.pool.writeU8(e.charCodeAt(t));break;case W:this.pool.writeVarint(r);for(let t=0;t<r;t++)this.pool.writeU8(e.charCodeAt(t));break;case _:case L:case $:var i=this.encoder.encode(e);t==_||t==L?this.pool.writeU8(i.length):this.pool.writeVarint(i.length),this.pool.writeBulkAligned(i,1)}}writeArray(e,t){var r=e.length;switch(t){case G:break;case H:this.pool.writeVarint(r);for(let t=0;t<r;t++)this.writeValue(e[t]);break;case J:this.writeSparseArray(e);break;case K:case Q:case X:case Y:case Z:this.pool.writePackedArray(e,t)}}writeSparseArray(e){var t=e.length,r=new Uint32Array(t),i=[];let s=0;for(let a=0;a<t;a++)a in e&&(r[s]=a,i[s]=e[a],s++);this.pool.writeVarint(t),this.pool.writeVarint(s);for(let e=0;e<s;e++)this.pool.writeVarint(r[e]),this.writeValue(i[e])}writeObject(e,t){if(t!=ee)switch(t){case re:case te:this.writeSimpleObject(e);break;case se:this.writeObjectWithDescriptors(e);break;case ae:this.writeObjectWithMethods(e);break;case ie:this.writeConstructorObject(e)}}writeSimpleObject(e){var t,r=Object.keys(e).filter(t=>{try{return"function"!=typeof e[t]||this.options.serializeFunctions}catch(t){return!1}});for(t of(r.sort(),this.pool.writeVarint(r.length),r))this.writeValue(t),this.writeValue(e[t])}writeObjectWithDescriptors(e){var t,r=Object.getOwnPropertyNames(e),i=Object.getOwnPropertySymbols(e);r=[...r,...i].filter(t=>{try{var r=Object.getOwnPropertyDescriptor(e,t);return r&&(this.options.serializeFunctions||!r.get&&!r.set&&"function"!=typeof r.value)}catch(t){return!1}});for(t of(this.pool.writeVarint(r.length),r)){this.writeValue(t);var s=Object.getOwnPropertyDescriptor(e,t);let r=0;s.enumerable&&(r|=1),s.writable&&(r|=2),s.configurable&&(r|=4),s.get&&(r|=8),s.set&&(r|=16),this.pool.writeU8(r),s.get||s.set?(s.get&&this.writeValue(s.get),s.set&&this.writeValue(s.set)):this.writeValue(s.value)}}writeObjectWithMethods(e){var t,r,i,s,a=[];for(t of Object.keys(e))try{var o=e[t];"function"==typeof o?this.options.serializeFunctions?a.push([t,o,!0]):a.push([t,null,!1]):a.push([t,o,!1])}catch(e){}for([r,i,s]of(this.pool.writeVarint(a.length),a))this.writeValue(r),this.pool.writeU8(s?1:0),s&&this.options.serializeFunctions?(this.writeValue(i.toString()),this.writeValue(i.name||"")):s?this.pool.writeU8(Le):this.writeValue(i)}writeConstructorObject(e){this.writeValue(e.constructor.name||"");var t,r=Object.keys(e).filter(t=>{try{return"function"!=typeof e[t]||this.options.serializeFunctions}catch(t){return!1}});for(t of(this.pool.writeVarint(r.length),r))this.writeValue(t),this.writeValue(e[t])}writeTypedArray(e,t){var r=e.buffer,i=e.byteOffset,s=e.length;if(this.options.shareArrayBuffers){if(void 0!==(a=this.buffers.get(r)))return this.pool.writeU8(1),this.pool.writeVarint(a),this.pool.writeVarint(i),void this.pool.writeVarint(s);this.buffers.set(r,this.buffers.size)}this.pool.writeU8(0),this.pool.writeVarint(i),this.pool.writeVarint(s);var a,o=s*(a=qe[t]||1);if(t==de||t==ye)for(let t=0;t<s;t++)this.pool.writeBigInt64(e[t]);else t=new Uint8Array(r,i,o),this.pool.writeBulkAligned(t,a)}writeArrayBuffer(e,t){e=new Uint8Array(e),this.pool.writeVarint(e.length),this.pool.writeBulkAligned(e,1)}writeCollection(e,t){switch(t){case ke:for(var[r,i]of(this.pool.writeVarint(e.size),e))this.writeValue(r),this.writeValue(i);break;case Ae:for(var s of(this.pool.writeVarint(e.size),e))this.writeValue(s)}}writeDate(e,t){t==me&&this.pool.writeF64(e.getTime())}writeError(e,t){if(this.writeValue(e.message||""),this.writeValue(e.stack||""),t==Pe&&e.errors)for(var r of(this.pool.writeVarint(e.errors.length),e.errors))this.writeValue(r)}writeRegExp(e){this.writeValue(e.source),this.writeValue(e.flags)}writeBinary(e,t){this.pool.writeVarint(0),this.pool.writeVarint(0)}writeSpecial(e,t){switch(t){case De:var r=e.description;this.writeValue(r);break;case _e:break;case Ne:r=Symbol.keyFor(e),this.writeValue(r||"");break;case We:r=Ge.get(e),this.writeValue(r||"")}}writeExtension(e,t){}deserialize(e){if(this.buffer=new Uint8Array(e),this.view=new DataView(this.buffer.buffer,this.buffer.byteOffset),this.pos=0,this.deserializeRefs=[],this.deserializeStrings=[],this.deserializeBuffers=[],1413632565!==this.readU32())throw new Error("Invalid TurboSerial data");if(5!==(e=this.readU8()))throw new Error("Unsupported version: "+e);return this.readValue()}readValue(){if(this.pos>=this.buffer.length)throw new Error("Unexpected end of buffer");var e=this.readU8();if(e==Re||e==Ce){var t=this.readVarint();if(t>=this.deserializeRefs.length)throw new Error("Invalid reference: "+t);return this.deserializeRefs[t]}if(e==q){if((t=this.readVarint())>=this.deserializeStrings.length)throw new Error("Invalid string reference: "+t);return this.deserializeStrings[t]}if(e==ve){if((t=this.readVarint())>=this.deserializeBuffers.length)throw new Error("Invalid buffer reference: "+t);return this.deserializeBuffers[t]}let r,v=!1;switch(t=e&i){case l:case h:case f:v=!0}if(v){switch(t){case h:r=[];break;case f:e==ke?r=new Map:e==Ae&&(r=new Set);break;case l:r={}}switch(r&&this.deserializeRefs.push(r),t){case h:this.fillArray(r,e);break;case l:this.fillObject(r,e);break;case f:this.fillCollection(r,e)}}else{switch(t){case s:r=this.readPrimitive(e);break;case a:r=this.readNumber(e);break;case o:r=this.readBigInt(e);break;case n:r=this.readString(e);break;case c:r=this.readTypedArray(e);break;case u:r=this.readArrayBuffer(e);break;case p:r=this.readDate(e);break;case w:r=this.readError(e);break;case d:r=this.readRegExp();break;case y:r=this.readBinary(e);break;case b:r=this.readSpecial(e);break;case g:r=this.readExtension(e);break;default:throw new Error("Unknown type: 0x"+e.toString(16))}"object"!=typeof r||null==r||v||this.deserializeRefs.push(r)}return r}fillArray(e,t){switch(t){case G:break;case H:var r=this.readVarint();for(let t=0;t<r;t++)e[t]=this.readValue();break;case J:var i=this.readVarint(),s=this.readVarint();e.length=i;for(let t=0;t<s;t++)e[this.readVarint()]=this.readValue();break;case K:case Q:case X:case Y:case Z:i=this.readPackedArrayData(t),e.push(...i)}}fillObject(e,t){if(t!=ee)switch(t){case re:case te:this.fillSimpleObject(e);break;case se:this.fillObjectWithDescriptors(e);break;case ae:this.fillObjectWithMethods(e);break;case ie:this.fillConstructorObject(e)}}fillSimpleObject(e){var t=this.readVarint();for(let r=0;r<t;r++)e[this.readValue()]=this.readValue()}fillObjectWithDescriptors(e){var t=this.readVarint();for(let o=0;o<t;o++){var r=this.readValue(),i={enumerable:!!(1&(a=this.readU8())),writable:!!(2&a),configurable:!!(4&a)},s=!!(8&a),a=!!(16&a);s||a?(s&&(i.get=this.readValue()),a&&(i.set=this.readValue())):i.value=this.readValue(),Object.defineProperty(e,r,i)}}fillObjectWithMethods(e){var t=this.readVarint();for(let s=0;s<t;s++){var r=this.readValue();if(this.readU8())if(this.options.serializeFunctions){var i=this.readValue();this.readValue();try{e[r]=new Function("return "+i)()}catch(t){e[r]=function(){throw new Error("Function deserialization failed")}}}else this.readU8()===Le&&(e[r]=function(){throw new Error("Function not serialized")});else e[r]=this.readValue()}}fillConstructorObject(e){var t=this.readValue(),r=this.readVarint();for(let t=0;t<r;t++)e[this.readValue()]=this.readValue();Object.defineProperty(e,"__constructorName",{value:t,enumerable:!1,writable:!1,configurable:!0})}fillCollection(e,t){var r=this.readVarint();switch(t){case ke:for(let t=0;t<r;t++){var i=this.readValue(),s=this.readValue();e.set(i,s)}break;case Ae:for(let t=0;t<r;t++)e.add(this.readValue())}}readPrimitive(e){switch(e){case v:return null;case V:return;case k:return!1;case A:return!0;default:throw new Error("Unknown primitive: 0x"+e.toString(16))}}readNumber(e){switch(e){case m:return this.view.getInt8(this.pos++);case U:return this.readI16();case B:return this.readI32();case S:return this.readU32();case O:return this.readF32();case I:return this.readF64();case E:return NaN;case z:return 1/0;case M:return-1/0;case P:return-0;case j:var t=this.readVarint();return this.readU8()?-t:t;default:throw new Error("Unknown number type: 0x"+e.toString(16))}}readBigInt(e){switch(e){case x:case F:return this.readBigInt64();case T:case R:return this.readLargeBigInt(e==R);default:throw new Error("Unknown BigInt type: 0x"+e.toString(16))}}readLargeBigInt(e){var t=this.readVarint(),r=(this.ensureBytes(t),this.buffer.subarray(this.pos,this.pos+t));this.pos+=t;let i="";for(let e=r.length-1;0<=e;e--)i+=r[e].toString(16).padStart(2,"0");return t=BigInt("0x"+i),e?-t:t}readString(e){if(e==C)return"";let t,r;switch(e){case D:case N:case _:case L:t=this.readU8();break;default:t=this.readVarint()}if(this.ensureBytes(t),e==D||e==N||e==W){r="";for(let e=0;e<t;e++)r+=String.fromCharCode(this.readU8())}else e=this.buffer.subarray(this.pos,this.pos+t),this.pos+=t,r=this.decoder.decode(e);return this.deserializeStrings.push(r),r}readPackedArrayData(e){var t=this.readVarint(),r=new Array(t),i=qe[e];if(!i)throw new Error("Unknown packed array type: 0x"+e.toString(16));switch(this.alignPos(Math.min(i,8)),this.ensureBytes(t*i),e){case K:for(let e=0;e<t;e++)r[e]=this.view.getInt8(this.pos++);break;case Q:for(let e=0;e<t;e++)r[e]=this.view.getInt16(this.pos,!0),this.pos+=2;break;case X:for(let e=0;e<t;e++)r[e]=this.view.getInt32(this.pos,!0),this.pos+=4;break;case Y:for(let e=0;e<t;e++)r[e]=this.view.getFloat32(this.pos,!0),this.pos+=4;break;case Z:for(let e=0;e<t;e++)r[e]=this.view.getFloat64(this.pos,!0),this.pos+=8}return r}readTypedArray(e){if(this.readU8()){var t=this.readVarint(),r=this.readVarint(),i=this.readVarint();if(t>=this.deserializeBuffers.length)throw new Error("Invalid buffer reference: "+t);return t=this.deserializeBuffers[t],this.createTypedArray(e,t,r,i)}this.readVarint();var s=this.readVarint();t=qe[e]||1;if(e!=de&&e!=ye)return r=s*t,this.alignPos(t),this.ensureBytes(r),i=this.buffer.subarray(this.pos,this.pos+r),this.pos+=r,t=new ArrayBuffer(r),new Uint8Array(t).set(i),this.deserializeBuffers.push(t),this.createTypedArray(e,t,0,s);this.alignPos(8);var a=[];for(let e=0;e<s;e++)a.push(this.readBigInt64());return new(e==de?BigInt64Array:BigUint64Array)(a)}createTypedArray(e,t,r,i){var s={[oe]:Uint8Array,[ne]:Int8Array,[he]:Uint8ClampedArray,[le]:Uint16Array,[ce]:Int16Array,[ue]:Uint32Array,[fe]:Int32Array,[pe]:Float32Array,[we]:Float64Array,[de]:BigInt64Array,[ye]:BigUint64Array,[be]:DataView}[e];if(s)return new s(t,r,i);throw new Error("Unknown typed array type: 0x"+e.toString(16))}readArrayBuffer(e){var t=this.readVarint(),r=(this.ensureBytes(t),this.buffer.subarray(this.pos,this.pos+t));this.pos+=t,t=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);return this.deserializeBuffers.push(t),t}readDate(e){switch(e){case me:return new Date(this.readF64());case Ue:return new Date(NaN);default:throw new Error("Unknown date type: 0x"+e.toString(16))}}readError(e){var t=this.readValue(),r=this.readValue();let i;var s={[Be]:Error,[Se]:EvalError,[Oe]:RangeError,[Ie]:ReferenceError,[Ee]:SyntaxError,[ze]:TypeError,[Me]:URIError}[e]||Error;if(e==Pe){var a=this.readVarint(),o=[];for(let e=0;e<a;e++)o.push(this.readValue());i=new AggregateError(o,t)}else i=new s(t);return r&&(i.stack=r),i}readRegExp(){var e=this.readValue(),t=this.readValue();return new RegExp(e,t)}readBinary(e){return{_type:"Binary",size:this.readVarint(),typeStr:this.readVarint()}}readSpecial(e){switch(e){case De:var t=this.readValue();return Symbol(t);case _e:return Symbol();case Ne:return t=this.readValue(),Symbol.for(t);case We:return t=this.readValue(),He.get(t)||Symbol(t);default:throw new Error("Unknown special type: 0x"+e.toString(16))}}readExtension(e){if(e!==Le)throw new Error("Unknown extension type: 0x"+e.toString(16));return function(){throw new Error("Function not serialized")}}readU8(){return this.ensureBytes(1),this.buffer[this.pos++]}readI16(){this.alignPos(2),this.ensureBytes(2);var e=this.view.getInt16(this.pos,!0);return this.pos+=2,e}readU16(){this.alignPos(2),this.ensureBytes(2);var e=this.view.getUint16(this.pos,!0);return this.pos+=2,e}readI32(){this.alignPos(4),this.ensureBytes(4);var e=this.view.getInt32(this.pos,!0);return this.pos+=4,e}readU32(){this.alignPos(4),this.ensureBytes(4);var e=this.view.getUint32(this.pos,!0);return this.pos+=4,e}readF32(){this.alignPos(4),this.ensureBytes(4);var e=this.view.getFloat32(this.pos,!0);return this.pos+=4,e}readF64(){this.alignPos(8),this.ensureBytes(8);var e=this.view.getFloat64(this.pos,!0);return this.pos+=8,e}readBigInt64(){this.alignPos(8),this.ensureBytes(8);var e=this.view.getBigInt64(this.pos,!0);return this.pos+=8,e}readVarint(){let e=0,t=0;for(var r;this.ensureBytes(1),e|=(127&(r=this.buffer[this.pos++]))<<t,t+=7,128&r;);return e>>>0}alignPos(e){e=e-1|0,this.pos=(this.pos+e&~e)>>>0}ensureBytes(e){if(this.pos+e>this.buffer.length)throw new Error(`Buffer underflow: need ${e}, available `+(this.buffer.length-this.pos))}}}]);